{"version":3,"file":"crusoris.cjs.js","sources":["../source/events.ts","../source/entity.ts","../source/modules/dot.ts","../source/utils.ts","../source/modules/tail.ts","../source/index.ts"],"sourcesContent":["import { Cursor } from '~/index';\r\n// import { Status } from './utils';\r\n\r\nexport namespace events {\r\n\r\n  type CB = Array<() => void>;\r\n\r\n  export function mousemove(event: MouseEvent, instance: Cursor, cb: CB) {\r\n\r\n    instance.position = {\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n    }\r\n\r\n    cb.forEach(f => f());\r\n\r\n  }\r\n\r\n  export function click(_event: MouseEvent, _instance: Cursor, cb: CB) {\r\n\r\n    // ...\r\n\r\n    cb.forEach(f => f());\r\n\r\n  }\r\n\r\n}","import type { ElementPosition, Cursor } from '~/index';\r\n\r\nexport interface IParams {\r\n  // className: string;\r\n}\r\n\r\ninterface EntityStruct {\r\n\r\n  transforms: {\r\n    size: number;\r\n    scale: number;\r\n    rotate: number;\r\n  }\r\n\r\n}\r\n\r\nexport abstract class Entity implements EntityStruct {\r\n\r\n  protected instance: Cursor;\r\n\r\n  public element: HTMLElement;\r\n\r\n  public transforms = {\r\n    size: 4,\r\n    scale: 1,\r\n    rotate: 0,\r\n    duration: 250,\r\n  }\r\n\r\n  constructor(instance: Cursor) {\r\n\r\n    this.instance = instance;\r\n\r\n    this.element = document.createElement('span');\r\n\r\n    this.setStyles();\r\n\r\n  }\r\n\r\n  private get position(): ElementPosition {\r\n    return {\r\n      x: this.instance.position.x,\r\n      y: this.instance.position.y,\r\n    }\r\n  }\r\n\r\n  public update() {\r\n    this.setStyles();\r\n  }\r\n\r\n  private setStyles() {\r\n\r\n    const TRANSLATE: string = `translate(${ this.position.x }px, ${ this.position.y }px)`;\r\n    const SCALE: string     = `scale(${ this.transforms.scale })`\r\n    const ROTATE: string    = `rotate(${ this.transforms.rotate }deg)`;\r\n\r\n    this.element.style.setProperty('transform', `${ TRANSLATE } ${ ROTATE } ${ SCALE }`);\r\n    this.element.style.setProperty('--size', `${ this.transforms.size }px`);\r\n    this.element.style.setProperty('--duration', `${ this.transforms.duration }ms`);\r\n\r\n  }\r\n\r\n}","import { Entity, IParams } from '~/entity';\r\nimport type { Cursor } from '~/index';\r\n\r\ninterface IDot extends IParams {\r\n}\r\n\r\nexport class Dot extends Entity implements IDot {\r\n\r\n  private static readonly className: string = 'eccheuma-cursor-dot';\r\n\r\n  constructor(instance: Cursor) { super(instance);\r\n    this.element.className = Dot.className;\r\n  }\r\n\r\n  public activeAnimation(status: boolean): void {\r\n\r\n    this.element.getAnimations().forEach(anim => anim.cancel());\r\n\r\n    this.element.animate([\r\n      { transform: 'scale(1)' },\r\n      { transform: 'scale(2)' },\r\n    ], {\r\n      duration: this.transforms.duration,\r\n      composite: 'accumulate',\r\n      iterations: status ? Infinity : 2,\r\n      direction: 'alternate',\r\n      fill: 'both'\r\n    })\r\n\r\n  }\r\n\r\n}","export function css(data: TemplateStringsArray): string {\r\n  return String(data);\r\n};\r\n\r\nexport const enum Status {\r\n  idle,\r\n  active,\r\n  await\r\n}","import { Entity, IParams } from '~/entity';\r\nimport { Cursor } from '~/index';\r\n\r\nimport { Status } from '~/utils';\r\n\r\ninterface ITail extends IParams {\r\n}\r\n\r\nexport class Tail extends Entity implements ITail {\r\n\r\n  public static readonly className: string = 'eccheuma-cursor-tail';\r\n\r\n  constructor(instance: Cursor) { super(instance);\r\n    this.element.className = Tail.className;\r\n  }\r\n\r\n  set newScale(value: number) {\r\n    this.transforms.scale = value; this.update();\r\n  }\r\n\r\n  public clickAnimation() {\r\n\r\n    this.element.style.opacity = '1';\r\n\r\n    this.newScale = 2;\r\n\r\n  }\r\n\r\n  public hideAnimation() {\r\n\r\n    this.element.style.opacity = '.25';\r\n\r\n    this.newScale = .75;\r\n\r\n  }\r\n\r\n  public appearAnimation(status: Status) {\r\n\r\n    this.element.style.opacity = '1';\r\n\r\n    switch (status) {\r\n      case Status.active: \r\n        this.newScale = 1; break;\r\n      case Status.idle: \r\n        this.newScale = 0; break;\r\n    }\r\n  \r\n  }\r\n\r\n}","import { events } from '~/events';\r\n\r\n// ELEMENTS\r\nimport { Dot } from '~/modules/dot';\r\nimport { Tail } from '~/modules/tail';\r\n\r\nimport { css, Status } from '~/utils';\r\n\r\nexport type ElementPosition = {\r\n  x: number,\r\n  y: number,\r\n}\r\n\r\n// STYLES\r\nconst STYLES = css`\r\n\r\n  :host {\r\n    pointer-events: none;\r\n    position: absolute;\r\n    height: 1px;\r\n    width: 1px;\r\n    top: 0;\r\n    left: 0; \r\n    background: orange;  \r\n    z-index: 9999; \r\n  }\r\n\r\n  .eccheuma-cursor-tail {\r\n\r\n    --size: 40px;\r\n    --duration: 250ms;\r\n\r\n    display: block;\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    height: var(--size);\r\n    width: var(--size);\r\n    border-radius: calc(var(--size) / 3);\r\n    border: 2px solid var(--crusoris-color-tail, #FFFFFF);\r\n    z-index: 1;\r\n    transition-duration: var(--duration);\r\n    transition-timing-function: ease-out;\r\n    margin: calc((var(--size) / 2) * -1) calc((var(--size) / 2) * -1);\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  .eccheuma-cursor-dot {\r\n\r\n    --size: 10px;\r\n    --dur: 250ms;\r\n\r\n    display: block;\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    height: var(--size);\r\n    width: var(--size);\r\n    background: var(--crusoris-color-dot, #FFFFFF);\r\n    border: 2px solid var(--crusoris-color-accent, #AAAAAA);\r\n    border-radius: 100%;\r\n    z-index: 2;\r\n    margin: calc((var(--size) / 2) * -1) calc((var(--size) / 2) * -1);\r\n    box-sizing: border-box;\r\n\r\n  }\r\n\r\n`\r\n\r\nenum ComponentAttributes {\r\n  dotSize = 'dot-size',\r\n  tailSize = 'tail-size',\r\n  rotate = 'rotate',\r\n  duration = 'duration',\r\n  action = 'action'\r\n}\r\n\r\nexport class Cursor extends HTMLElement {\r\n\r\n  public static readonly ITER_TIMEOUT = 750;\r\n\r\n  public root: ShadowRoot | HTMLElement = this;\r\n  public position: ElementPosition = {\r\n    x: window.innerWidth / 2,\r\n    y: window.innerHeight / 2,\r\n  }\r\n\r\n  public dotInstance: Dot;\r\n  public tailInstance: Tail;\r\n\r\n  public status: Status = Status.idle;\r\n  public action: boolean = false;\r\n\r\n  constructor() { super();\r\n\r\n    this.root = this.attachShadow({ mode: 'open' });\r\n\r\n    Array.from(this.children).forEach(elem => {\r\n      this.root.append(elem)\r\n    })\r\n\r\n    const DOMStyle = document.createElement('style');\r\n          DOMStyle.textContent = STYLES\r\n            .replaceAll(new RegExp('\\\\s{2,}', 'g'), String());\r\n\r\n    this.root.append(DOMStyle);\r\n\r\n    this.tailInstance = new Tail(this);\r\n    this.dotInstance  = new Dot(this);\r\n\r\n    this.root.append(this.dotInstance.element);\r\n    this.root.append(this.tailInstance.element);\r\n\r\n    // setInterval(() => {\r\n    //   this.setAttribute('action', this.action ? 'false' : 'true');\r\n    // }, 3000)\r\n    \r\n  }\r\n\r\n  static get observedAttributes(): Array<ComponentAttributes> { \r\n    return [\r\n      ComponentAttributes.dotSize,\r\n      ComponentAttributes.tailSize,\r\n      ComponentAttributes.rotate,\r\n      ComponentAttributes.duration,\r\n      ComponentAttributes.action,\r\n    ]\r\n  }\r\n\r\n  set newStatus(value: Status) {\r\n\r\n    if ( this.status === value ) return;\r\n\r\n    this.status = value;\r\n\r\n    // ? TAIL REACTIONS\r\n    switch (value) {\r\n      case Status.active: this.tailInstance.appearAnimation(this.status); break;\r\n      case Status.idle: this.tailInstance.hideAnimation(); break;\r\n    }\r\n\r\n  }\r\n\r\n  private notify() {\r\n\r\n    [ this.dotInstance, this.tailInstance ].forEach((instance) => {\r\n      instance.update();\r\n    })\r\n  }\r\n\r\n  private idleChecker(pos: ElementPosition) {\r\n\r\n    this.newStatus = this.status !== Status.await\r\n      && pos.x === this.position.x \r\n      && pos.y === this.position.y\r\n      ? Status.idle\r\n      : this.status\r\n\r\n    setTimeout(() => {\r\n      this.idleChecker(this.position);\r\n    }, Cursor.ITER_TIMEOUT);\r\n\r\n  }\r\n\r\n  private setAciton(value: string, prev: string) {\r\n\r\n    if ( !prev ) return;\r\n\r\n    this.action = value === 'true' || value === 'false'\r\n      ? JSON.parse(value)\r\n      : this.action;\r\n\r\n    this.dotInstance.activeAnimation(this.action);\r\n\r\n  }\r\n\r\n  connectedCallback() {\r\n\r\n    document.body.style.cursor = 'none';\r\n\r\n    document.body.addEventListener('mousemove', (event) => {\r\n\r\n      this.newStatus = Status.active\r\n\r\n      events.mousemove(event, this, Array(0)); \r\n      \r\n      this.notify();\r\n\r\n    })\r\n\r\n    document.body.addEventListener('mousedown', (event) => {\r\n\r\n      this.newStatus = Status.await;\r\n\r\n      events.click(event, this, [\r\n        () => this.tailInstance.clickAnimation(),\r\n      ])\r\n\r\n    })\r\n\r\n    document.body.addEventListener('mouseup', (event) => {\r\n\r\n      this.newStatus = Status.active;\r\n\r\n      events.click(event, this, [\r\n        () => this.tailInstance.appearAnimation(this.status)\r\n      ])\r\n\r\n    })\r\n\r\n    this.idleChecker(this.position);\r\n\r\n  }\r\n\r\n  attributeChangedCallback(key: ComponentAttributes, oldValue: string, newValue: string) {\r\n\r\n    const DT = this.dotInstance.transforms;\r\n    const TT = this.tailInstance.transforms;\r\n    \r\n    switch (key) {\r\n\r\n      case ComponentAttributes.action: this.setAciton(newValue, oldValue); break\r\n\r\n      case ComponentAttributes.duration: \r\n        DT.duration = TT.duration = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.dotSize:\r\n        DT.size = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.tailSize:\r\n        TT.size = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.rotate:\r\n        TT.rotate = parseInt(newValue);\r\n        break;\r\n      \r\n    }\r\n\r\n    this.notify();\r\n\r\n  }\r\n\r\n}\r\n\r\ncustomElements.define('eccheuma-crusoris', Cursor);"],"names":["events","events2","mousemove","event","instance","cb","position","x","clientX","y","clientY","forEach","f","click","_event","_instance","Entity","constructor","__publicField","this","size","scale","rotate","duration","element","document","createElement","setStyles","update","TRANSLATE","SCALE","transforms","ROTATE","style","setProperty","_Dot","super","className","activeAnimation","status","getAnimations","anim","cancel","animate","transform","composite","iterations","Infinity","direction","fill","Dot","Status","Status2","_Tail","newScale","value","clickAnimation","opacity","hideAnimation","appearAnimation","active","idle","Tail","STYLES","data","String","_Cursor","HTMLElement","window","innerWidth","innerHeight","root","attachShadow","mode","Array","from","children","elem","append","DOMStyle","textContent","replaceAll","RegExp","tailInstance","dotInstance","observedAttributes","newStatus","notify","idleChecker","pos","await","setTimeout","ITER_TIMEOUT","setAciton","prev","action","JSON","parse","connectedCallback","body","cursor","addEventListener","attributeChangedCallback","key","oldValue","newValue","DT","TT","parseInt","Cursor","customElements","define"],"mappings":"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"}