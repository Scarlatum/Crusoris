{"version":3,"file":"crusoris.es.js","sources":["../source/status.ts","../source/events.ts","../source/modules/entity.ts","../source/modules/dot.ts","../source/modules/tail.ts","../source/index.ts"],"sourcesContent":["export const enum cursorStatus {\r\n  click,\r\n  idle,\r\n  await,\r\n  move,\r\n  context\r\n}","import type { Cursor } from '~/index';\r\nimport { cursorStatus } from '~/status';\r\n\r\nexport namespace events {\r\n\r\n  const enum errorAlias {\r\n    define\r\n  }\r\n\r\n  const errors: {[A in keyof typeof errorAlias]: Error } = {\r\n    define: new Error('Cursor is not defined')\r\n  }\r\n\r\n  export function click(_ev: MouseEvent, cursor?: Cursor) {\r\n\r\n    if ( !cursor ) throw errors.define;\r\n\r\n    cursor.newStatus = cursorStatus.click;\r\n\r\n    // ! Тут должно быть больше кода\r\n\r\n    cursor.newStatus = cursorStatus.await;\r\n\r\n  }\r\n\r\n  export function mousemove(event: MouseEvent, cursor?: Cursor) {\r\n\r\n    if ( !cursor ) throw errors.define;\r\n\r\n    cursor.newStatus = cursorStatus.move;\r\n\r\n    cursor.newPosition = {\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n    };\r\n\r\n    cursor.newStatus = cursorStatus.await;\r\n\r\n  }\r\n\r\n}","import { Cursor, Position } from '~/index';\r\n\r\ninterface IEntity {\r\n  element: HTMLElement,\r\n}\r\n\r\ninterface Transforms {\r\n  rotate: number,\r\n  scale: number\r\n}\r\n\r\nexport abstract class Entity implements IEntity {\r\n\r\n  element: HTMLElement;\r\n  cursor: Cursor;\r\n\r\n  protected position: Position = {\r\n    x: 0,\r\n    y: 0,\r\n  };\r\n\r\n  private transforms: Transforms = {\r\n    rotate: 45,\r\n    scale: 1,\r\n  }\r\n\r\n  _size: number = 0;\r\n\r\n  constructor(cursor: Cursor) {\r\n\r\n    this.cursor = cursor;\r\n\r\n    this.element = document.createElement('span');\r\n\r\n    this.element.addEventListener('position', () => {\r\n      this.pos = cursor.position\r\n    })\r\n\r\n  }\r\n\r\n  set size(value: number,) {\r\n    this.element.style.setProperty('--size', `${ value }px`); this._size = value;\r\n  }\r\n\r\n  set pos(pos: Position) {\r\n    this.position = pos; this.updateProperty()\r\n  }\r\n\r\n  set scale(value: Transforms['scale']) {\r\n    this.transforms.scale = value; this.updateProperty();\r\n  }\r\n\r\n  get pos(): Position {\r\n    return {\r\n      x: this.position.x - this.anchor,\r\n      y: this.position.y - this.anchor,\r\n    }\r\n  }\r\n\r\n\r\n  abstract get anchor(): number;\r\n\r\n  updateProperty() {\r\n    this.element.style.setProperty('--y', `${ this.pos.y }px`);\r\n    this.element.style.setProperty('--x', `${ this.pos.x }px`);\r\n    this.element.style.setProperty('--s', String(this.transforms.scale))\r\n  }\r\n\r\n}","import styles from '~/css/main.module.css';\r\nimport { Entity } from '~/modules/entity'\r\nimport { Cursor } from '..';\r\n\r\nexport class Dot extends Entity {\r\n\r\n  constructor(cursor: Cursor) { super(cursor)\r\n    this.element.className = styles.dot;\r\n  }\r\n\r\n  get anchor() {\r\n    return (this._size / 2);\r\n  }\r\n\r\n}","import styles from '~/css/main.module.css';\r\nimport { Entity } from '~/modules/entity'\r\nimport { Cursor } from '~/index';\r\nimport { cursorStatus } from '~/status';\r\n\r\nexport class Tail extends Entity {\r\n\r\n  private border: number = 2;\r\n\r\n  constructor(cursor: Cursor) { super(cursor)\r\n\r\n    this.element.className = styles.tail;\r\n\r\n    this.element.addEventListener('status', () => {\r\n\r\n      switch (cursor.status) {\r\n        case cursorStatus.click: \r\n          this.action(); break;\r\n        case cursorStatus.idle: \r\n          this.hide(); break;\r\n        case cursorStatus.move:\r\n          this.revert(); break;\r\n      }\r\n\r\n    })\r\n\r\n  }\r\n\r\n  get anchor() {\r\n    return (this._size / 2) + this.border\r\n  }\r\n\r\n  private revert() {\r\n    this.scale = 1;\r\n  }\r\n\r\n  private hide() {\r\n    this.scale = 0;\r\n  }\r\n\r\n  private action() {\r\n\r\n    this.scale = 2;\r\n\r\n    setTimeout(() => {\r\n      this.revert(); this.cursor.newStatus = cursorStatus.await\r\n    }, 250);\r\n\r\n  }\r\n\r\n}","import { cursorStatus } from '~/status';\nimport { events } from '~/events';\n\nimport { Dot } from '~/modules/dot';\nimport { Tail } from './modules/tail';\n\n// const enum DEFAULTS {\n//   DOT_SIZE = 10,\n//   TAIL_SIZE = 20,\n//   TAIL_ROTATE = 45,\n// }\n\nenum ComponentAttributes {\n  dotSize = 'dot-size',\n  tailSize = 'tail-size',\n  tailRotate = 'tail-rotate'\n}\n\nexport type Position = {\n  x: number,\n  y: number,\n}\n\nexport class Cursor extends HTMLElement {\n\n  readonly dot: Dot;\n  readonly tail: Tail;\n\n  public listeners: Record<keyof typeof events, (e: MouseEvent) => void> = Object();\n\n  public position: Position  = {\n    x: 0,\n    y: 0,\n  }\n\n  public customEvents = {\n    position: new Event('position'),\n    status: new Event('status'),\n  }\n\n  public status: cursorStatus = cursorStatus.idle;\n\n  constructor() { super();\n\n    this.dot  = new Dot(this);\n    this.tail = new Tail(this);\n\n    this.append(this.dot.element);\n    this.append(this.tail.element);\n\n    this.listeners.click = (e) => events.click(e, this);\n    this.listeners.mousemove  = (e) => events.mousemove(e, this);\n\n    this.idleChecker(this.position);\n\n  }\n\n  static get observedAttributes() { \n    return [\n      ComponentAttributes.dotSize,\n      ComponentAttributes.tailSize,\n    ]\n  }\n\n  set newStatus(value: cursorStatus) {\n\n    if ( value === this.status ) return;\n\n    this.status = value;\n\n    this.tail.element.dispatchEvent(this.customEvents.status);\n    this.dot.element.dispatchEvent(this.customEvents.status);\n\n  }\n\n  set newPosition(pos: Position) {\n\n    this.position = pos; \n    \n    this.tail.element.dispatchEvent(this.customEvents.position);\n    this.dot.element.dispatchEvent(this.customEvents.position);\n\n  }\n\n  idleChecker(pos: Position) {\n    setTimeout(() => {\n\n      if ( pos.x === this.position.x && pos.y === this.position.y && this.status === cursorStatus.await ) {\n        this.newStatus = cursorStatus.idle;\n      }\n\n      this.idleChecker(this.position);\n\n    }, 1000)\n  }\n\n  connectedCallback() {\n\n    this.parentElement!.style.cursor = 'none';\n\n    this.parentElement!.addEventListener('mousemove', this.listeners.mousemove);\n    this.parentElement!.addEventListener('click', this.listeners.click);\n\n  }\n\n  disconnectedCallback() {\n    this.parentElement!.removeEventListener('mousemove', this.listeners.mousemove);\n    this.parentElement!.removeEventListener('click', this.listeners.click);\n  }\n\n  attributeChangedCallback(key: string, _oldValue: string, newValue: string) {\n\n    switch (key) {\n      case ComponentAttributes.dotSize:\n        this.dot.size = parseInt(newValue); break;\n      case ComponentAttributes.tailSize:\n        this.tail.size = parseInt(newValue); break;\n    }\n\n  }\n\n}\n\nwindow.customElements.define('eccheuma-cursor', Cursor);\n"],"names":[],"mappings":"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"}