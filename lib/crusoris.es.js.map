{"version":3,"file":"crusoris.es.js","sources":["../source/events.ts","../source/entity.ts","../source/modules/dot.ts","../source/utils.ts","../source/modules/tail.ts","../source/index.ts"],"sourcesContent":["import { Cursor } from '~/index';\r\n// import { Status } from './utils';\r\n\r\nexport namespace events {\r\n\r\n  type CB = Array<() => void>;\r\n\r\n  export function mousemove(event: MouseEvent, instance: Cursor, cb: CB) {\r\n\r\n    instance.position = {\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n    }\r\n\r\n    cb.forEach(f => f());\r\n\r\n  }\r\n\r\n  export function click(_event: MouseEvent, _instance: Cursor, cb: CB) {\r\n\r\n    // ...\r\n\r\n    cb.forEach(f => f());\r\n\r\n  }\r\n\r\n}","import type { ElementPosition, Cursor } from '~/index';\r\n\r\nexport interface IParams {\r\n  // className: string;\r\n}\r\n\r\ninterface EntityStruct {\r\n\r\n  transforms: {\r\n    size: number;\r\n    scale: number;\r\n    rotate: number;\r\n  }\r\n\r\n}\r\n\r\nexport abstract class Entity implements EntityStruct {\r\n\r\n  protected instance: Cursor;\r\n\r\n  public element: HTMLElement;\r\n\r\n  public transforms = {\r\n    size: 4,\r\n    scale: 1,\r\n    rotate: 0,\r\n    duration: 250,\r\n  }\r\n\r\n  constructor(instance: Cursor) {\r\n\r\n    this.instance = instance;\r\n\r\n    this.element = document.createElement('span');\r\n\r\n    this.setStyles();\r\n\r\n  }\r\n\r\n  private get position(): ElementPosition {\r\n    return {\r\n      x: this.instance.position.x,\r\n      y: this.instance.position.y,\r\n    }\r\n  }\r\n\r\n  public update() {\r\n    this.setStyles();\r\n  }\r\n\r\n  private setStyles() {\r\n\r\n    const TRANSLATE: string = `translate(${ this.position.x }px, ${ this.position.y }px)`;\r\n    const SCALE: string     = `scale(${ this.transforms.scale })`\r\n    const ROTATE: string    = `rotate(${ this.transforms.rotate }deg)`;\r\n\r\n    this.element.style.setProperty('transform', `${ TRANSLATE } ${ ROTATE } ${ SCALE }`);\r\n    this.element.style.setProperty('--size', `${ this.transforms.size }px`);\r\n    this.element.style.setProperty('--duration', `${ this.transforms.duration }ms`);\r\n\r\n  }\r\n\r\n}","import { Entity, IParams } from '~/entity';\r\nimport type { Cursor } from '~/index';\r\n\r\ninterface IDot extends IParams {\r\n}\r\n\r\nexport class Dot extends Entity implements IDot {\r\n\r\n  private static readonly className: string = 'eccheuma-cursor-dot';\r\n\r\n  constructor(instance: Cursor) { super(instance);\r\n    this.element.className = Dot.className;\r\n  }\r\n\r\n  public activeAnimation(status: boolean): void {\r\n\r\n    this.element.getAnimations().forEach(anim => anim.cancel());\r\n\r\n    this.element.animate([\r\n      { transform: 'scale(1)' },\r\n      { transform: 'scale(2)' },\r\n    ], {\r\n      duration: this.transforms.duration,\r\n      composite: 'accumulate',\r\n      iterations: status ? Infinity : 2,\r\n      direction: 'alternate',\r\n      fill: 'both'\r\n    })\r\n\r\n  }\r\n\r\n}","export function css(data: TemplateStringsArray): string {\r\n  return String(data);\r\n};\r\n\r\nexport const enum Status {\r\n  idle,\r\n  active,\r\n  await\r\n}","import { Entity, IParams } from '~/entity';\r\nimport { Cursor } from '~/index';\r\n\r\nimport { Status } from '~/utils';\r\n\r\ninterface ITail extends IParams {\r\n}\r\n\r\nexport class Tail extends Entity implements ITail {\r\n\r\n  public static readonly className: string = 'eccheuma-cursor-tail';\r\n\r\n  constructor(instance: Cursor) { super(instance);\r\n    this.element.className = Tail.className;\r\n  }\r\n\r\n  set newScale(value: number) {\r\n    this.transforms.scale = value; this.update();\r\n  }\r\n\r\n  public clickAnimation() {\r\n\r\n    this.element.style.opacity = '1';\r\n\r\n    this.newScale = 2;\r\n\r\n  }\r\n\r\n  public hideAnimation() {\r\n\r\n    this.element.style.opacity = '.25';\r\n\r\n    this.newScale = .75;\r\n\r\n  }\r\n\r\n  public appearAnimation(status: Status) {\r\n\r\n    this.element.style.opacity = '1';\r\n\r\n    switch (status) {\r\n      case Status.active: \r\n        this.newScale = 1; break;\r\n      case Status.idle: \r\n        this.newScale = 0; break;\r\n    }\r\n  \r\n  }\r\n\r\n}","import { events } from '~/events';\r\n\r\n// ELEMENTS\r\nimport { Dot } from '~/modules/dot';\r\nimport { Tail } from '~/modules/tail';\r\n\r\nimport { css, Status } from '~/utils';\r\n\r\nexport type ElementPosition = {\r\n  x: number,\r\n  y: number,\r\n}\r\n\r\n// STYLES\r\nconst STYLES = css`\r\n\r\n  :host {\r\n    pointer-events: none;\r\n    position: absolute;\r\n    height: 1px;\r\n    width: 1px;\r\n    top: 0;\r\n    left: 0; \r\n    background: orange;  \r\n    z-index: 9999; \r\n  }\r\n\r\n  .eccheuma-cursor-tail {\r\n\r\n    --size: 40px;\r\n    --duration: 250ms;\r\n\r\n    display: block;\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    height: var(--size);\r\n    width: var(--size);\r\n    border-radius: calc(var(--size) / 3);\r\n    border: 2px solid var(--crusoris-color-tail, #FFFFFF);\r\n    z-index: 1;\r\n    transition-duration: var(--duration);\r\n    transition-timing-function: ease-out;\r\n    margin: calc((var(--size) / 2) * -1) calc((var(--size) / 2) * -1);\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  .eccheuma-cursor-dot {\r\n\r\n    --size: 10px;\r\n    --dur: 250ms;\r\n\r\n    display: block;\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    height: var(--size);\r\n    width: var(--size);\r\n    background: var(--crusoris-color-dot, #FFFFFF);\r\n    border: 2px solid var(--crusoris-color-accent, #AAAAAA);\r\n    border-radius: 100%;\r\n    z-index: 2;\r\n    margin: calc((var(--size) / 2) * -1) calc((var(--size) / 2) * -1);\r\n    box-sizing: border-box;\r\n\r\n  }\r\n\r\n`\r\n\r\nenum ComponentAttributes {\r\n  dotSize = 'dot-size',\r\n  tailSize = 'tail-size',\r\n  rotate = 'rotate',\r\n  duration = 'duration',\r\n  action = 'action'\r\n}\r\n\r\nexport class Cursor extends HTMLElement {\r\n\r\n  public static readonly ITER_TIMEOUT = 750;\r\n\r\n  public root: ShadowRoot | HTMLElement = this;\r\n  public position: ElementPosition = {\r\n    x: window.innerWidth / 2,\r\n    y: window.innerHeight / 2,\r\n  }\r\n\r\n  public dotInstance: Dot;\r\n  public tailInstance: Tail;\r\n\r\n  public status: Status = Status.idle;\r\n  public action: boolean = false;\r\n\r\n  constructor() { super();\r\n\r\n    this.root = this.attachShadow({ mode: 'open' });\r\n\r\n    Array.from(this.children).forEach(elem => {\r\n      this.root.append(elem)\r\n    })\r\n\r\n    const DOMStyle = document.createElement('style');\r\n          DOMStyle.textContent = STYLES\r\n            .replaceAll(new RegExp('\\\\s{2,}', 'g'), String());\r\n\r\n    this.root.append(DOMStyle);\r\n\r\n    this.tailInstance = new Tail(this);\r\n    this.dotInstance  = new Dot(this);\r\n\r\n    this.root.append(this.dotInstance.element);\r\n    this.root.append(this.tailInstance.element);\r\n\r\n    // setInterval(() => {\r\n    //   this.setAttribute('action', this.action ? 'false' : 'true');\r\n    // }, 3000)\r\n    \r\n  }\r\n\r\n  static get observedAttributes(): Array<ComponentAttributes> { \r\n    return [\r\n      ComponentAttributes.dotSize,\r\n      ComponentAttributes.tailSize,\r\n      ComponentAttributes.rotate,\r\n      ComponentAttributes.duration,\r\n      ComponentAttributes.action,\r\n    ]\r\n  }\r\n\r\n  set newStatus(value: Status) {\r\n\r\n    if ( this.status === value ) return;\r\n\r\n    this.status = value;\r\n\r\n    // ? TAIL REACTIONS\r\n    switch (value) {\r\n      case Status.active: this.tailInstance.appearAnimation(this.status); break;\r\n      case Status.idle: this.tailInstance.hideAnimation(); break;\r\n    }\r\n\r\n  }\r\n\r\n  private notify() {\r\n\r\n    [ this.dotInstance, this.tailInstance ].forEach((instance) => {\r\n      instance.update();\r\n    })\r\n  }\r\n\r\n  private idleChecker(pos: ElementPosition) {\r\n\r\n    this.newStatus = this.status !== Status.await\r\n      && pos.x === this.position.x \r\n      && pos.y === this.position.y\r\n      ? Status.idle\r\n      : this.status\r\n\r\n    setTimeout(() => {\r\n      this.idleChecker(this.position);\r\n    }, Cursor.ITER_TIMEOUT);\r\n\r\n  }\r\n\r\n  private setAciton(value: string, prev: string) {\r\n\r\n    if ( !prev ) return;\r\n\r\n    this.action = value === 'true' || value === 'false'\r\n      ? JSON.parse(value)\r\n      : this.action;\r\n\r\n    this.dotInstance.activeAnimation(this.action);\r\n\r\n  }\r\n\r\n  connectedCallback() {\r\n\r\n    document.body.style.cursor = 'none';\r\n\r\n    document.body.addEventListener('mousemove', (event) => {\r\n\r\n      this.newStatus = Status.active\r\n\r\n      events.mousemove(event, this, Array(0)); \r\n      \r\n      this.notify();\r\n\r\n    })\r\n\r\n    document.body.addEventListener('mousedown', (event) => {\r\n\r\n      this.newStatus = Status.await;\r\n\r\n      events.click(event, this, [\r\n        () => this.tailInstance.clickAnimation(),\r\n      ])\r\n\r\n    })\r\n\r\n    document.body.addEventListener('mouseup', (event) => {\r\n\r\n      this.newStatus = Status.active;\r\n\r\n      events.click(event, this, [\r\n        () => this.tailInstance.appearAnimation(this.status)\r\n      ])\r\n\r\n    })\r\n\r\n    this.idleChecker(this.position);\r\n\r\n  }\r\n\r\n  attributeChangedCallback(key: ComponentAttributes, oldValue: string, newValue: string) {\r\n\r\n    const DT = this.dotInstance.transforms;\r\n    const TT = this.tailInstance.transforms;\r\n    \r\n    switch (key) {\r\n\r\n      case ComponentAttributes.action: this.setAciton(newValue, oldValue); break\r\n\r\n      case ComponentAttributes.duration: \r\n        DT.duration = TT.duration = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.dotSize:\r\n        DT.size = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.tailSize:\r\n        TT.size = parseInt(newValue);\r\n        break;\r\n\r\n      case ComponentAttributes.rotate:\r\n        TT.rotate = parseInt(newValue);\r\n        break;\r\n      \r\n    }\r\n\r\n    this.notify();\r\n\r\n  }\r\n\r\n}\r\n\r\ncustomElements.define('eccheuma-crusoris', Cursor);"],"names":[],"mappings":"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"}